-- 第20回オフラインリアルタイムどう書くの問題
-- 会議の時間
-- http://qiita.com/Nabetani/items/5791f8ae1bb5d069a49b

import Data.List.Split
import Data.List
import Text.Printf

type Schedule = (Char, Int, Int)

solve :: String -> String
solve = output . search . parse

parse :: String -> [Schedule]
parse input = do
    (person:range) <- sort $ splitOn "," input
    let [from, to] = splitOn "-" range
    return $ (person, (timeToInt from), (timeToInt to))

search :: [Schedule] -> [Int]
search schedules = [start | start <- [10*60..17*60], p <- ["IZ", "JZ"], check schedules p start]

output :: [Int] -> String
output [] = "-"
output (start:_) = intToTime start ++ '-' : intToTime (start + 60)

check :: [Schedule] -> String -> Int -> Bool
check schedules person start = all available range
    where
        range = [start..start+59]
        available time = let ps = [p | (p, a, b) <- schedules, a <= time && time < b]
                         in  ps == "Z" || ps == person

timeToInt :: String -> Int
timeToInt (h1:h2:m1:m2:[]) = (read [h1, h2]) * 60 + (read [m1, m2])
timeToInt _ = error "invalid argument"

intToTime :: Int -> String
intToTime x = printf "%02d%02d" (x `div` 60) (x `mod` 60)


test :: String -> String -> IO ()
test input expected
    | result == expected = return ()
    | otherwise          = error $ show input ++ " -- expected " ++ show expected ++ " but " ++ show result
    where
        result = solve input

main :: IO ()
main = do
    test "A1050-1130,B1400-1415,I1000-1400,I1600-1800,J1100-1745,Z1400-1421,Z1425-1800"                                  "1425-1525"
    test "A1000-1200,B1300-1800,Z1000-1215,Z1230-1800"                                                                   "-"
    test "Z0800-2200"                                                                                                    "1000-1100"
    test "A1000-1700,Z0800-2200"                                                                                         "1700-1800"
    test "A1000-1701,Z0800-2200"                                                                                         "-"
    test "A1000-1130,B1230-1800,Z0800-2200"                                                                              "1130-1230"
    test "A1000-1129,B1230-1800,Z0800-2200"                                                                              "1129-1229"
    test "A1000-1131,B1230-1800,Z0800-2200"                                                                              "-"
    test "A1000-1130,B1229-1800,Z0800-2200"                                                                              "-"
    test "A1000-1130,B1231-1800,Z0800-2200"                                                                              "1130-1230"
    test "A1000-1130,B1230-1800,Z0800-1130,Z1131-2200"                                                                   "-"
    test "A1000-1130,B1231-1800,Z0800-1130,Z1131-2200"                                                                   "1131-1231"
    test "Z0800-0801"                                                                                                    "-"
    test "Z0800-1031,Z1129-1220,Z1315-1400,Z1459-1600"                                                                   "1459-1559"
    test "Z0800-2200,I1000-1600,J1030-1730"                                                                              "1600-1700"
    test "Z0800-2200,I1000-1600,J1130-1730"                                                                              "1000-1100"
    test "Z0800-2200,I1000-1600,J1130-1730,A0800-1025"                                                                   "1025-1125"
    test "Z0800-2200,I1000-1600,J1130-1730,A0800-1645"                                                                   "1645-1745"
    test "Z0800-2200,I1000-1600,J1130-1730,A0800-1645,I1735-2200"                                                        "-"
    test "Z0800-2200,I1000-1600,J1130-1730,A0800-1645,J1735-2200"                                                        "1645-1745"
    test "Z1030-2200,I1000-1600,J1130-1730"                                                                              "1030-1130"
    test "Z1035-1500,I1000-1600,J1130-1730,Z1644-2200"                                                                   "1644-1744"
    test "I2344-2350,A2016-2253,Z1246-1952"                                                                              "1246-1346"
    test "Z2155-2157,B1822-2032,Z1404-2000,Z2042-2147,Z2149-2154"                                                        "1404-1504"
    test "Z2231-2250,Z2128-2219,B2219-2227,B2229-2230,Z0713-2121,A0825-1035,B1834-2001"                                  "1035-1135"
    test "J0807-1247,I0911-1414,B1004-1553,Z0626-1732,Z1830-1905,A1946-1954,A0623-1921"                                  "-"
    test "J1539-1733,J0633-1514,Z1831-1939,J1956-1959,I0817-1007,I1052-1524,Z1235-1756,Z0656-1144"                       "1524-1624"
    test "Z2319-2350,B0833-2028,I2044-2222,A1410-2201,Z2044-2228,Z0830-2023,Z2242-2306,I2355-2359"                       "-"
    test "B2001-2118,Z0712-1634,I1941-2102,B1436-1917"                                                                   "1000-1100"
    test "A0755-1417,B2303-2335,Z0854-2150,Z2348-2356,Z2156-2340,I1024-1307,Z2357-2359"                                  "1417-1517"
    test "A1958-1959,B0822-1155,I1518-1622,Z1406-1947,A1800-1822,A0904-1422,J1730-1924,Z1954-1958,A1946-1956"            "1422-1522"
    test "B1610-1910,I2121-2139,A0619-1412,I2147-2153,Z0602-2111,I0841-2031,A1657-1905,A1956-2047,J0959-1032,Z2131-2147" "1412-1512"
    test "Z0623-1900,A0703-1129,I1815-1910,J1956-1957,I0844-1518,Z1902-1935,B1312-1342,J1817-1955"                       "1129-1229"
    test "J1246-1328,B1323-1449,I1039-1746,Z1218-2111"                                                                   "1449-1549"
    test "A1958-1959,I1943-1944,I0731-1722,Z0845-1846,J1044-1513,Z1910-1923,B1216-1249"                                  "1513-1613"
    test "A1855-2047,Z0946-1849,Z2056-2059,I1855-1910,B1946-2058,I1956-2025,Z1905-2054,J0644-1800,I0720-1618"            "1618-1718"
    test "J1525-1950,Z0905-1933,A1648-1716,I2051-2054,I2015-2044,I0804-1958,B0934-1100,Z1953-2037"                       "1100-1200"
    test "Z1914-1956,J0823-1610,Z0641-1841,J1800-1835,A0831-1346,I1926-1941,I1030-1558,I1738-1803"                       "1558-1658"
    test "Z0625-1758,J1033-1351,B1816-2236,I0838-1615,J2247-2255"                                                        "1351-1451"
    test "J0603-1233,A1059-1213,I1326-2103,Z0710-1459"                                                                   "1213-1313"
    test "B1302-1351,J1410-2038,A0755-1342,J0637-0658,Z2148-2159,Z1050-2131,A1543-1844,I1615-1810"                       "1351-1451"
    test "Z0746-2100,A2122-2156,I1022-1144,J0947-1441,A1333-1949"                                                        "1144-1244"
    test "J0718-1243,Z1443-1818,B2055-2057,A0714-1238,Z1045-1344,A1643-1717,B1832-2039,J1623-1931"                       "1238-1338"
    test "Z1921-1933,A1208-1418,I0827-1940,Z0757-1917,J0653-1554,B1859-1909"                                             "1554-1654"
